let owl,gl_lFT=!1,productDetail={productSlideThumbnail:function(){$.getScript(base_url+"mobile/js/owl.carousel.js").done(function(){owl=$("#banner").owlCarousel({autoPlay:5e3,margin:0,nav:!0,dots:!1,lazyLoad:!0,navText:['<i class="fa fa-angle-left"></i>','<i class="fa fa-angle-right"></i>'],stopOnHover:!0,scrollPerPage:!0,responsive:{0:{items:4,slideBy:4},768:{items:7,slideBy:7},1024:{items:5,slideBy:5}}})}),$("body").on("click","#banner .item",function(){if(!$(this).hasClass("active_")){let e=$(this).data("img");$("#banner .item").removeClass("active_"),$(this).addClass("active_"),$(".main-image").append('<div style="opacity: 0" class="inner-image"><div class="zone-item"><img src="'+e+'" class="img-fluid"></div></div>'),$(".main-image .inner-image").eq(0).animate({opacity:0},500,function(){$(".main-image .inner-image").eq(0).remove()}),$(".main-image .inner-image").eq(1).animate({opacity:1},1e3),image_active=$(this).data("target")}})},slideProduct:function(){let e=$("#sticky-image").find(".slide-step");if(!e.length)return;let t,o=null,i=e.find(".slide-lager"),a=i.find(".swiper-container"),n=e.find(".slide-thumb"),l=n.find(".swiper-container"),s=n.find(".thumb-item"),r=function(){image_active=t.activeIndex,o.slideTo(t.activeIndex),s.removeClass("is-active"),n.find('.thumb-item[data-target="'+t.activeIndex+'"]').addClass("is-active")};o=new Swiper(l,{navigation:{nextEl:n.find(".swiper-button-next"),prevEl:n.find(".swiper-button-prev")},preloadImages:!1,slidesPerView:4,spaceBetween:6,direction:"vertical",height:290,slideToClickedSlide:!0}),t=new Swiper(a,{preloadImages:!1,slidesPerView:1,spaceBetween:30,onTransitionStart:function(){r()}}),r(),n.on("click",".thumb-item",function(e){e.preventDefault(),t.slideTo($(this).data("target")),r()}),i.on("touchend",function(e){e.preventDefault(),o.slideTo(t.activeIndex),r()})},loadGallery:function(){if(gl_lFT){let e=$(".fotorama").on("fotorama:ready fotorama:show fotorama:showend fotorama:load fotorama:error fotorama:startautoplay fotorama:stopautoplay fotorama:fullscreenenter fotorama:fullscreenexit fotorama:loadvideo fotorama:unloadvideo",function(e,t,o){"fotorama:fullscreenexit"==e.type&&t.destroy()}).fotorama({click:!1,allowfullscreen:!0}).data("fotorama"),t=[];$(".lager-item").each(function(){t.push({img:$(this).data("max"),thumb:$(this).data("thumb")})}),e.load(t),e.show(image_active),e.requestFullScreen()}else $.getScript(base_url+"desktop/js/fotorama.js").done(function(){gl_lFT=!0,productDetail.loadGallery()})},scrollProduct:function(){$('.product-nav a[href^="#"]').on("click",function(e){let t=$(this.getAttribute("href"));t.length&&($(".scroll-nav a").removeClass("active"),$(this).addClass("active"),e.preventDefault(),$("html, body").stop().animate({scrollTop:t.offset().top-120},300),console.log(t.offset().top-120))})},viewHistory:function(){$("#product-history").length>0&&Vnit.builIScroll("#product-history")},logHistoryView:function(e){$.ajax({url:base_url+"customer/history/add",type:"POST",data:{product_id:e,_token:_token},dataType:"json",success:function(e){},error:function(e,t,o){console.log(o+"\r\n"+e.statusText+"\r\n"+e.responseText)}})},productSimilar:function(){$.ajax({url:base_url+"product/similar",type:"post",data:{_token:_token,product_id:product_id,vendor:vendor},dataType:"json",success:function(e){""!=e.html&&($("#zone-bought").html(e.html),$(".product-similar").show(),Vnit.builIScroll("#product-similar"))},error:function(e,t,o){console.log(o+"\r\n"+e.statusText+"\r\n"+e.responseText)}})},loadGallery:function(){if(gl_lFT){let e=$(".fotorama").on("fotorama:ready fotorama:show fotorama:showend fotorama:load fotorama:error fotorama:startautoplay fotorama:stopautoplay fotorama:fullscreenenter fotorama:fullscreenexit fotorama:loadvideo fotorama:unloadvideo",function(e,t,o){"fotorama:fullscreenexit"==e.type&&t.destroy()}).fotorama({click:!1,allowfullscreen:!0}).data("fotorama"),t=[];$("#banner .item").each(function(){t.push({img:$(this).data("max"),thumb:$(this).data("thumb")})}),e.load(t),e.show(image_active),e.requestFullScreen()}else $.getScript(base_url+"desktop/js/fotorama.js").done(function(){gl_lFT=!0,productDetail.loadGallery()})},initAmazon:function(){$(document).on("click",".main-image",function(){productDetail.loadGallery()}),$(document).on("change",".p-attr",function(){Vnit.loading(),window.location.href=base_url+"amazon/"+$(this).val()+"/{{ $slug }}.html"}),$(document).on("click",".gird-color li",function(){$(".gird-color li").removeClass("selected"),$(this).addClass("selected");let e=$(this).data("name");$(".color-active").text(e),window.location.href=$(this).data("link"),Vnit.loading()}),Vnit.isInView(".zone-button")?($("#button-fly").removeClass("in-view"),console.log("in-view")):($("#button-fly").addClass("in-view"),console.log("out-view")),$(window).scroll(function(){Vnit.isInView(".zone-button")?($("#button-fly").removeClass("in-view"),console.log("in-view")):($("#button-fly").addClass("in-view"),console.log("out-view"))}),$(".buy-now, .add-cart").prop("disabled",!0),$(".main-image").css({height:$(".main-image").width()}),Vnit.loadSelect2()},Init:function(){productDetail.productSlideThumbnail(),productDetail.productSimilar(),productDetail.viewHistory(),productDetail.logHistoryView(product_id),Vnit.showMoreContent("#js-description"),Vnit.loadSelect2(),Vnit.isInView(".zone-button")?($("#button-fly").removeClass("in-view"),console.log("in-view")):($("#button-fly").addClass("in-view"),console.log("out-view")),$(window).scroll(function(){Vnit.isInView(".zone-button")?($("#button-fly").removeClass("in-view"),console.log("in-view")):($("#button-fly").addClass("in-view"),console.log("out-view"))}),$(document).on("click",".main-image",function(){productDetail.loadGallery()}),$(".main-image, .inner-image").css({height:$(document).width()}),$(".product-table-title").click(function(){let e=$(this).data("id");$(this).hasClass("active")?($(this).removeClass("active"),$("#"+e).slideUp()):($(this).addClass("active"),$("#"+e).slideDown())}),$("#js-description img").each(function(){$(this).removeClass().addClass("img-fluid lazy")})}};$(document).ready(function(){productDetail.Init()});let productEbay={ebayOption:function(){let e={};$(".msku-sel").change(function(){let t=$(this);if("Color"==t.data("name")||"Colors"==t.data("name")){let o=t.find(":selected").data("text");e=color_pic[o]?color_pic[o]:images_list}t.prop("selected",!0);let o=[],i=[],a=$(this).attr("name"),n=$(this).val(),l=$(this).attr("id");for(let e=0;e<Object.keys(menu).length;e++){let t=Object.keys(menu)[e];menu[t].traitValuesMap[a]==n&&o.push(t)}for(k=0;k<o.length;k++)for(d=0;d<menuItemMap.length;d++){let e=menuItemMap[d];in_array(o[k],e.matchingVariationIds)&&(in_array(e.valueId,i)||i.push(e.valueId))}let s={};$(".msku-sel").each(function(){let e=$(this),t=e.attr("id"),o=e.attr("name");for("-1"==n?(e.find("option").each(function(){$(this).prop("selected",!1),$(this).removeAttr("hidden")}),$("[name=price_key]").val("")):(l!=t&&e.find("option").each(function(){let e=$(this).val();-1!=e?in_array(e,i)?$(this).removeAttr("hidden"):($(this).attr("hidden","hidden"),$(this).prop("selected",!1)):$("[name=price_key]").val("")}),e.find("option:selected")&&(-1!=e.find("option:selected").val()?s[o]=parseInt(e.find("option:selected").val()):$("[name=price_key]").val(""))),d=0;d<Object.keys(menu).length;d++){key=Object.keys(menu)[d],item=menu[key],equals(item.traitValuesMap,s)&&(select_menu=item,$("[name=price_key]").val(key),console.log(select_menu),console.log(key))}});let r=0;if(select_menu.qty&&select_menu.qty>0){r=select_menu.qty-select_menu.sold,$("#qty_available").text(r),$("#qty_sold").text(select_menu.sold),$("#current_price").text(number_format(select_menu.price_convert,0,".",","));let e='<option value="0">Số lượng</option>';for(d=1;d<=r;d++)e+='<option value="'+d+'">'+d+"</option>";$("#qty").html(e),r<=0?($("#qty").prop("disabled",!0),$(".buy-now, .add-cart").prop("disabled",!0),$(".product-qty-warning").show()):($("#qty").prop("disabled",!1),$(".buy-now, .add-cart").prop("disabled",!1),$(".product-qty-warning").hide())}else{r=0,$("#qty_available").text(r),$("#qty_sold").text(select_menu.sold);let e='<option value="0">Số lượng</option>';$("#qty").html(e),r<=0?($("#qty").prop("disabled",!0),$(".add-cart").prop("disabled",!0),$(".product-qty-warning").show()):($("#qty").prop("disabled",!1),$(".add-cart").prop("disabled",!1),$(".product-qty-warning").hide())}if(e&&Object.keys(e).length>0){for(var d=0;d<100;d++)owl.trigger("remove.owl.carousel",[d]);for(d=0;d<Object.keys(e).length;d++)owl.trigger("add.owl.carousel",['<div class="item" data-img="'+e[d]+'"><div class="i-img"><img src="'+e[d]+'" alt=""></div></div>']);owl.trigger("refresh.owl.carousel"),$(".main-image").html('<div class="inner-image"><div class="zone-item"><img src="'+e[0]+'" class="img-fluid"></div></div>')}})},Init:function(){productEbay.ebayOption()}};$(document).ready(function(){productEbay.Init()});